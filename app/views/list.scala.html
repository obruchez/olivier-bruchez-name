@import util.Introduction

@(page: Page, introductionOption: Option[Introduction], items: Seq[ListItem], header: play.twirl.api.Html, rowFromItem: (ListItem) => play.twirl.api.Html)

@import util.Date._

@table(yearOption: Option[Int], itemsForYear: Seq[ListItem]) = {
  <div class="panel panel-u">
    <div class="panel-heading panel-title">
      <section id="@yearOption.fold("?")(_.toString)">
        <i class="fa fa-calendar"></i>
        <span class="panel-year" >@yearOption.fold("?")(_.toString)</span>
        <span class="pull-right"><span class="badge rounded-2x badge-dark panel-count">@itemsForYear.size</span></span>

      </section>
    </div>
    <table class="table table-bordered table-striped">
      <thead>
        @header
      </thead>
      <tbody>
        @itemsForYear.map { item => @rowFromItem(item) }
      </tbody>
    </table>
  </div>
}

@main(page) {
  @introductionOption.map { introduction =>
    <div class="tag-box tag-box-v2">
      @Html(introduction.fullVersion.string) <span class="badge rounded-2x badge-dark pull-right">@items.size</span>
    </div>
  }
  @items.groupBy(_.date.year).toSeq.sortBy(_._1).reverseMap { case (yearOption, itemsForYear) =>
    @table(yearOption, itemsForYear)
  }
}
